
<!DOCTYPE html>
<html lang="cmn-Hans">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>为网页添加一个回到顶部按钮 | 一斤瓜子铺</title><link rel="canonical" href="https://caixw.io/posts/2012/goto-top.html" /><link rel="icon" type="image/svg&#43;xml" href="/favicon.svg" />
        <link rel=”mask-icon” href=”/favicon.svg” color=”#000000” /><link rel="alternate" type="application/rss+xml" title="RSS" href="https://caixw.io/rss.xml" /><link rel="alternate" type="application/atom+xml" title="Atom" href="https://caixw.io/atom.xml" /><meta name="keywords" content="javascript, 代码片段, snippet, goto-top" /><link rel="next" href="https://caixw.io/posts/2012/php-logs.html" /><link rel="prev" href="https://caixw.io/posts/2016/restful-api-guide.html" /><link rel="stylesheet" type="text/css" media="(prefers-color-scheme: dark)" href="https://caixw.io/themes/default/solarized-dark256.css" /><link rel="stylesheet" type="text/css" media="(prefers-color-scheme: light)" href="https://caixw.io/themes/default/solarized-light.css" /><link rel="stylesheet" type="text/css" media="print" href="https://caixw.io/themes/default/igor.css" /><link rel="stylesheet" type="text/css" href="https://caixw.io/themes/default/style.css" /><script type="application/ld+json">
        {"@context":"https://schema.org/","@type":"BlogPosting","headline":"为网页添加一个回到顶部按钮","author":[{"@type":"Person","name":"caixw","url":"https://caixw.io"}],"dateCreated":"2012-12-11T15:08:00+08:00","dateModified":"2021-04-02T21:05:00+08:00","license":"https://creativecommons.org/licenses/by/4.0/deed.zh","keywords":"javascript, 代码片段, snippet, goto-top","inLanguage":"cmn-Hans"}
        </script></head>

    <body>

    <main id="main">

<article class="post">
<h1>为网页添加一个回到顶部按钮</h1>
<div class="meta">
    <span class="item">
        <span class="value">作者:</span>
            <a class="value" href="https://caixw.io">caixw</a>
            </span>

    <div class="item">
        <span class="value">标签:</span><a class="value" href="https://caixw.io/tags/javascript.html">JavaScript</a><a class="value" href="https://caixw.io/tags/snippet.html">代码片段</a></div>

    <div class="item" title="修改时间:2021-04-02T21:05:00&#43;08:00&#10;添加时间:2012-12-11T15:08:00&#43;08:00">
        <span class="value">修改时间:</span>
        <time class="value">2021-04-02</time>
    </div>
</div>
<article id="content">
<pre tabindex="0" class="hl-chroma"><span class="hl-ln"> 1</span><span class="hl-cm">/*
</span><span class="hl-ln"> 2</span><span class="hl-cm"> * 在页面上产生个 gotop 按钮。
</span><span class="hl-ln"> 3</span><span class="hl-cm"> * 用纯粹的 JS 实现，无须额外的 CSS 和 HTML 支持。
</span><span class="hl-ln"> 4</span><span class="hl-cm"> *
</span><span class="hl-ln"> 5</span><span class="hl-cm"> * @param int width 网页的主体宽度，以下三种取值
</span><span class="hl-ln"> 6</span><span class="hl-cm"> * - 0 按钮靠浏览器左
</span><span class="hl-ln"> 7</span><span class="hl-cm"> * - -1 按钮靠流利器右
</span><span class="hl-ln"> 8</span><span class="hl-cm"> * - 其它正数 按钮靠网页内容右侧
</span><span class="hl-ln"> 9</span><span class="hl-cm"> * @return void
</span><span class="hl-ln">10</span><span class="hl-cm"> */</span> 
<span class="hl-ln">11</span><span class="hl-kd">function</span> <span class="hl-nx">gotoTop</span><span class="hl-p">(</span><span class="hl-nx">width</span><span class="hl-p">)</span> <span class="hl-p">{</span>
<span class="hl-ln">12</span>    <span class="hl-nb">document</span><span class="hl-p">.</span><span class="hl-nx">write</span><span class="hl-p">(</span><span class="hl-s1">&#39;&lt;a id=&#34;goto-top&#34;&gt;^&lt;/a&gt;&#39;</span><span class="hl-p">);</span> 
<span class="hl-ln">13</span>    <span class="hl-kd">var</span> <span class="hl-nx">gotop</span> <span class="hl-o">=</span> <span class="hl-nb">document</span><span class="hl-p">.</span><span class="hl-nx">querySelector</span><span class="hl-p">(</span><span class="hl-s1">&#39;#goto-top&#39;</span><span class="hl-p">);</span>
<span class="hl-ln">14</span>
<span class="hl-ln">15</span>    <span class="hl-cm">/* 默认情况下 CSS 属性的设置 */</span>
<span class="hl-ln">16</span>    <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">visibility</span><span class="hl-o">=</span><span class="hl-s1">&#39;hidden&#39;</span><span class="hl-p">;</span>
<span class="hl-ln">17</span>    <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">cursor</span><span class="hl-o">=</span><span class="hl-s1">&#39;pointer&#39;</span><span class="hl-p">;</span>
<span class="hl-ln">18</span>    <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">position</span> <span class="hl-o">=</span> <span class="hl-s1">&#39;fixed&#39;</span><span class="hl-p">;</span>
<span class="hl-ln">19</span>    <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">fontSize</span><span class="hl-o">=</span><span class="hl-s1">&#39;2.5em&#39;</span><span class="hl-p">;</span>
<span class="hl-ln">20</span>    <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">fontWeight</span><span class="hl-o">=</span><span class="hl-s1">&#39;900&#39;</span><span class="hl-p">;</span>
<span class="hl-ln">21</span>    <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">textAlign</span><span class="hl-o">=</span><span class="hl-s1">&#39;center&#39;</span><span class="hl-p">;</span>
<span class="hl-ln">22</span>    <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">background</span> <span class="hl-o">=</span> <span class="hl-s1">&#39;gray&#39;</span><span class="hl-p">;</span>
<span class="hl-ln">23</span>    <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">borderRadius</span> <span class="hl-o">=</span> <span class="hl-s1">&#39;0.2em&#39;</span><span class="hl-p">;</span>
<span class="hl-ln">24</span>    <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">width</span><span class="hl-o">=</span><span class="hl-s1">&#39;1.4em&#39;</span><span class="hl-p">;</span>
<span class="hl-ln">25</span>    <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">height</span><span class="hl-o">=</span><span class="hl-s1">&#39;1em&#39;</span><span class="hl-p">;</span>
<span class="hl-ln">26</span>    <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">top</span> <span class="hl-o">=</span> <span class="hl-p">(</span><span class="hl-nb">document</span><span class="hl-p">.</span><span class="hl-nx">documentElement</span><span class="hl-p">.</span><span class="hl-nx">clientHeight</span> <span class="hl-o">/</span> <span class="hl-mi">2</span><span class="hl-p">)</span> <span class="hl-o">+</span> <span class="hl-mi">100</span> <span class="hl-o">+</span> <span class="hl-s1">&#39;px&#39;</span><span class="hl-p">;</span>
<span class="hl-ln">27</span>    <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">opacity</span><span class="hl-o">=</span><span class="hl-s1">&#39;0.3&#39;</span><span class="hl-p">;</span>
<span class="hl-ln">28</span>    <span class="hl-kd">var</span> <span class="hl-nx">scrollTop</span> <span class="hl-o">=</span> <span class="hl-nb">document</span><span class="hl-p">.</span><span class="hl-nx">body</span><span class="hl-p">.</span><span class="hl-nx">scrollTop</span> <span class="hl-o">+</span> <span class="hl-nb">document</span><span class="hl-p">.</span><span class="hl-nx">documentElement</span><span class="hl-p">.</span><span class="hl-nx">scrollTop</span><span class="hl-p">;</span>
<span class="hl-ln">29</span>    <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">visibility</span> <span class="hl-o">=</span> <span class="hl-nx">scrollTop</span> <span class="hl-o">&gt;</span> <span class="hl-mi">10</span> <span class="hl-o">?</span> <span class="hl-s1">&#39;visible&#39;</span> <span class="hl-o">:</span> <span class="hl-s1">&#39;hidden&#39;</span><span class="hl-p">;</span>
<span class="hl-ln">30</span>
<span class="hl-ln">31</span>    <span class="hl-k">if</span><span class="hl-p">(</span><span class="hl-mi">0</span> <span class="hl-o">==</span> <span class="hl-nx">width</span><span class="hl-p">)</span> <span class="hl-p">{</span>
<span class="hl-ln">32</span>        <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">left</span> <span class="hl-o">=</span> <span class="hl-s1">&#39;0em&#39;</span><span class="hl-p">;</span>
<span class="hl-ln">33</span>    <span class="hl-p">}</span> <span class="hl-k">else</span> <span class="hl-k">if</span><span class="hl-p">(</span><span class="hl-o">-</span><span class="hl-mi">1</span> <span class="hl-o">==</span> <span class="hl-nx">width</span><span class="hl-p">)</span> <span class="hl-p">{</span>
<span class="hl-ln">34</span>        <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">right</span> <span class="hl-o">=</span> <span class="hl-s1">&#39;0em&#39;</span><span class="hl-p">;</span>
<span class="hl-ln">35</span>    <span class="hl-p">}</span> <span class="hl-k">else</span> <span class="hl-p">{</span>
<span class="hl-ln">36</span>        <span class="hl-kd">var</span> <span class="hl-nx">resize</span> <span class="hl-o">=</span> <span class="hl-kd">function</span><span class="hl-p">()</span> <span class="hl-p">{</span>
<span class="hl-ln">37</span>            <span class="hl-kd">var</span> <span class="hl-nx">left</span> <span class="hl-o">=</span> <span class="hl-p">(</span><span class="hl-nb">document</span><span class="hl-p">.</span><span class="hl-nx">documentElement</span><span class="hl-p">.</span><span class="hl-nx">clientWidth</span> <span class="hl-o">-</span> <span class="hl-nx">width</span><span class="hl-p">)</span> <span class="hl-o">/</span> <span class="hl-mi">2</span> <span class="hl-o">+</span> <span class="hl-nx">width</span> <span class="hl-o">+</span> <span class="hl-mi">10</span><span class="hl-p">;</span>
<span class="hl-ln">38</span>            <span class="hl-k">if</span><span class="hl-p">((</span><span class="hl-nx">left</span> <span class="hl-o">-</span> <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">clientWidth</span><span class="hl-p">)</span> <span class="hl-o">&lt;</span> <span class="hl-nx">width</span><span class="hl-p">)</span> <span class="hl-p">{</span>
<span class="hl-ln">39</span>                <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">right</span><span class="hl-o">=</span><span class="hl-s1">&#39;0em&#39;</span><span class="hl-p">;</span>
<span class="hl-ln">40</span>                <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">left</span> <span class="hl-o">=</span> <span class="hl-kc">null</span><span class="hl-p">;</span>  <span class="hl-c1">// 设定了right属性，则需要取消left属性。
</span><span class="hl-ln">41</span><span class="hl-c1"></span>            <span class="hl-p">}</span> <span class="hl-k">else</span> <span class="hl-p">{</span>
<span class="hl-ln">42</span>                <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">left</span> <span class="hl-o">=</span> <span class="hl-nx">left</span> <span class="hl-o">+</span> <span class="hl-s1">&#39;px&#39;</span><span class="hl-p">;</span>
<span class="hl-ln">43</span>                <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">right</span> <span class="hl-o">=</span> <span class="hl-kc">null</span><span class="hl-p">;</span>
<span class="hl-ln">44</span>            <span class="hl-p">}</span>
<span class="hl-ln">45</span>        <span class="hl-p">};</span>  <span class="hl-c1">// end resize
</span><span class="hl-ln">46</span><span class="hl-c1"></span>
<span class="hl-ln">47</span>        <span class="hl-nx">resize</span><span class="hl-p">();</span>
<span class="hl-ln">48</span>        <span class="hl-nb">window</span><span class="hl-p">.</span><span class="hl-nx">addEventListener</span><span class="hl-p">(</span><span class="hl-s1">&#39;resize&#39;</span><span class="hl-p">,</span> <span class="hl-kd">function</span><span class="hl-p">()</span> <span class="hl-p">{</span>
<span class="hl-ln">49</span>            <span class="hl-nx">resize</span><span class="hl-p">();</span>
<span class="hl-ln">50</span>        <span class="hl-p">},</span> <span class="hl-kc">false</span><span class="hl-p">);</span>
<span class="hl-ln">51</span>    <span class="hl-p">}</span> <span class="hl-c1">// end if
</span><span class="hl-ln">52</span><span class="hl-c1"></span>
<span class="hl-ln">53</span>    <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">addEventListener</span><span class="hl-p">(</span><span class="hl-s1">&#39;mouseover&#39;</span><span class="hl-p">,</span> <span class="hl-kd">function</span><span class="hl-p">()</span> <span class="hl-p">{</span>
<span class="hl-ln">54</span>        <span class="hl-k">this</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">opacity</span><span class="hl-o">=</span><span class="hl-s1">&#39;0.8&#39;</span><span class="hl-p">;</span>
<span class="hl-ln">55</span>        <span class="hl-k">this</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">textDecoration</span><span class="hl-o">=</span><span class="hl-s1">&#39;none&#39;</span><span class="hl-p">;</span>
<span class="hl-ln">56</span>    <span class="hl-p">},</span> <span class="hl-kc">false</span><span class="hl-p">);</span>
<span class="hl-ln">57</span>
<span class="hl-ln">58</span>    <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">addEventListener</span><span class="hl-p">(</span><span class="hl-s1">&#39;mouseout&#39;</span><span class="hl-p">,</span> <span class="hl-kd">function</span><span class="hl-p">()</span> <span class="hl-p">{</span>
<span class="hl-ln">59</span>        <span class="hl-k">this</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">opacity</span><span class="hl-o">=</span><span class="hl-s1">&#39;0.3&#39;</span><span class="hl-p">;</span>
<span class="hl-ln">60</span>    <span class="hl-p">},</span> <span class="hl-kc">false</span><span class="hl-p">);</span>
<span class="hl-ln">61</span>
<span class="hl-ln">62</span>    <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">addEventListener</span><span class="hl-p">(</span><span class="hl-s1">&#39;click&#39;</span><span class="hl-p">,</span> <span class="hl-kd">function</span><span class="hl-p">()</span> <span class="hl-p">{</span>
<span class="hl-ln">63</span>        <span class="hl-c1">// IE9 和 opera 下 body.scrollTop 为 0，chrome 下 documentElement.scrollTop 为 0
</span><span class="hl-ln">64</span><span class="hl-c1"></span>        <span class="hl-c1">// 两者始终有一个为 0 
</span><span class="hl-ln">65</span><span class="hl-c1"></span>        <span class="hl-kd">var</span> <span class="hl-nx">h</span> <span class="hl-o">=</span> <span class="hl-nb">document</span><span class="hl-p">.</span><span class="hl-nx">body</span><span class="hl-p">.</span><span class="hl-nx">scrollTop</span> <span class="hl-o">+</span> <span class="hl-nb">document</span><span class="hl-p">.</span><span class="hl-nx">documentElement</span><span class="hl-p">.</span><span class="hl-nx">scrollTop</span><span class="hl-p">;</span> <span class="hl-c1">// 当前位置 
</span><span class="hl-ln">66</span><span class="hl-c1"></span>        <span class="hl-kd">var</span> <span class="hl-nx">t</span> <span class="hl-o">=</span> <span class="hl-nb">window</span><span class="hl-p">.</span><span class="hl-nx">setInterval</span><span class="hl-p">(</span><span class="hl-kd">function</span><span class="hl-p">()</span> <span class="hl-p">{</span> 
<span class="hl-ln">67</span>            <span class="hl-nb">window</span><span class="hl-p">.</span><span class="hl-nx">scrollTo</span><span class="hl-p">(</span><span class="hl-mi">0</span><span class="hl-p">,</span><span class="hl-nx">h</span> <span class="hl-o">-=</span> <span class="hl-mi">100</span><span class="hl-p">);</span> <span class="hl-c1">// 每次上移 100 像素 
</span><span class="hl-ln">68</span><span class="hl-c1"></span>            <span class="hl-k">if</span><span class="hl-p">(</span><span class="hl-nx">h</span> <span class="hl-o">&lt;=</span> <span class="hl-mi">0</span><span class="hl-p">)</span> <span class="hl-p">{</span>
<span class="hl-ln">69</span>                <span class="hl-nb">window</span><span class="hl-p">.</span><span class="hl-nx">clearInterval</span><span class="hl-p">(</span><span class="hl-nx">t</span><span class="hl-p">);</span>
<span class="hl-ln">70</span>            <span class="hl-p">}</span>
<span class="hl-ln">71</span>        <span class="hl-p">},</span> <span class="hl-mi">5</span><span class="hl-p">);</span>
<span class="hl-ln">72</span>    <span class="hl-p">},</span> <span class="hl-kc">false</span><span class="hl-p">);</span> 
<span class="hl-ln">73</span>
<span class="hl-ln">74</span>    <span class="hl-cm">/* 通过 window.onscroll 事件确定按钮是否需要显示 */</span> 
<span class="hl-ln">75</span>    <span class="hl-nb">window</span><span class="hl-p">.</span><span class="hl-nx">addEventListener</span><span class="hl-p">(</span><span class="hl-s1">&#39;scroll&#39;</span><span class="hl-p">,</span> <span class="hl-kd">function</span><span class="hl-p">()</span> <span class="hl-p">{</span> 
<span class="hl-ln">76</span>        <span class="hl-kd">var</span> <span class="hl-nx">scrollTop</span> <span class="hl-o">=</span> <span class="hl-nb">document</span><span class="hl-p">.</span><span class="hl-nx">body</span><span class="hl-p">.</span><span class="hl-nx">scrollTop</span> <span class="hl-o">+</span> <span class="hl-nb">document</span><span class="hl-p">.</span><span class="hl-nx">documentElement</span><span class="hl-p">.</span><span class="hl-nx">scrollTop</span><span class="hl-p">;</span> 
<span class="hl-ln">77</span>        <span class="hl-nx">gotop</span><span class="hl-p">.</span><span class="hl-nx">style</span><span class="hl-p">.</span><span class="hl-nx">visibility</span> <span class="hl-o">=</span> <span class="hl-nx">scrollTop</span> <span class="hl-o">&gt;</span> <span class="hl-mi">10</span> <span class="hl-o">?</span> <span class="hl-s1">&#39;visible&#39;</span><span class="hl-o">:</span><span class="hl-s1">&#39;hidden&#39;</span><span class="hl-p">;</span> 
<span class="hl-ln">78</span>    <span class="hl-p">},</span> <span class="hl-kc">false</span><span class="hl-p">);</span> 
<span class="hl-ln">79</span><span class="hl-p">};</span>
</pre>
</article>
</article><div class="pages-nav">
                <span class="prev">
                        <a rel="prev" href="https://caixw.io/posts/2016/restful-api-guide.html" aria-label="前一页"><span aria-hidden="true">&#171;&#160;</span>RESTful API 设计实践</a>
                    </span>
                <span class="next">
                        <a rel="next" href="https://caixw.io/posts/2012/php-logs.html" aria-label="后一页">一个简单的日志记录函数<span aria-hidden="true">&#160;&#187;</span></a>
                    </span>
            </div>

        </main> 

        <footer id="footer">
            <div class="line" role="menu"><a role="menuitem" class="item" href="/">首页</a><a role="menuitem" class="item" href="/tags.html">标签</a><a role="menuitem" class="item" href="/archive.html">存档</a><a role="menuitem" class="item" href="/posts/about.html">关于</a><a role="menuitem" class="item" href="/rss.xml">RSS</a><a role="menuitem" class="item" href="/atom.xml">Atom</a><a role="menuitem" class="item" href="/sitemap.xml">Sitemap</a></div>

            <div class="line">
                <span class="item">&#169; 2016-2021 by
                    <a href="https://caixw.io" type="text/html">caixw</a>
                </span>
                <span class="item">主题采用 <a href="https://caixw.io">default</a></span>
                <span class="item">
                    由 <a href="https://github.com/caixw/blogit" type="text/html">blogit</a> 构建于
                    <time title="2021-08-22T17:09:56Z">2021-08-22</time>
                </span>
            </div>
        </footer>

        <span role="button" aria-label="go to top" id="goto-top" class="nav-button"><a href="#" class="css-icon icon-arrow-up"></a></span>
        <script src="https://caixw.io/themes/default/nav.js"></script>
    </body>
</html>
